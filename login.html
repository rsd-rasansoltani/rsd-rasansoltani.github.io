<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆØ±ÙˆØ¯ | Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</title>
    
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* ... (Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ CSS Ø´Ù…Ø§ Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±) ... */
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #f3f4f6;
            background-image: radial-gradient(#3b82f6 0.5px, #f3f4f6 0.5px);
            background-size: 10px 10px;
        }
        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }
        .input-field {
            transition: all 0.3s ease;
        }
        .input-field:focus {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.5);
        }
        /* Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ Ø¨Ø§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† */
        .hidden-section {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out;
        }
        .visible-section {
            display: block;
            opacity: 1;
            pointer-events: auto;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loader {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #3498db;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="glass w-full max-w-md rounded-2xl p-8 relative overflow-hidden">
        
        <div class="text-center mb-8">
            <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg shadow-blue-500/50">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
            </div>
            <h2 id="main-title" class="text-2xl font-bold text-gray-800">Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯</h2>
            <p id="sub-title" class="text-gray-500 text-sm mt-2">Ù„Ø·ÙØ§Ù‹ ÙˆØ§Ø±Ø¯ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø®ÙˆØ¯ Ø´ÙˆÛŒØ¯</p>
        </div>

        <div id="alert-box" class="hidden mb-4 p-3 rounded-lg text-sm text-center"></div>

        <div id="login-form" class="visible-section space-y-4">
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">Ø§ÛŒÙ…ÛŒÙ„</label>
                <input type="email" id="login-email" class="input-field w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:outline-none bg-gray-50" placeholder="name@example.com">
            </div>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                <input type="password" id="login-password" class="input-field w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:outline-none bg-gray-50" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
            </div>
            <div class="flex justify-end">
                <button onclick="switchView('reset')" class="text-sm text-blue-600 hover:text-blue-800 transition">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙØ±Ø§Ù…ÙˆØ´ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯ØŸ</button>
            </div>
            <button id="btn-login" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-lg shadow-blue-500/30 transition transform active:scale-95 flex justify-center items-center gap-2">
                <span>ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø­Ø³Ø§Ø¨</span>
            </button>
            <div class="mt-6 text-center text-sm">
                Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯ØŸ <button onclick="switchView('signup')" class="text-blue-600 font-bold hover:underline">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù†ÛŒØ¯</button>
            </div>
        </div>

        <div id="signup-form" class="hidden-section space-y-4" style="display: none;">
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">Ø§ÛŒÙ…ÛŒÙ„</label>
                <input type="email" id="signup-email" class="input-field w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:outline-none bg-gray-50">
            </div>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                <input type="password" id="signup-password" class="input-field w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:outline-none bg-gray-50" placeholder="Ø­Ø¯Ø§Ù‚Ù„ Û¶ Ú©Ø§Ø±Ø§Ú©ØªØ±">
            </div>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                <input type="password" id="signup-confirm-password" class="input-field w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:outline-none bg-gray-50">
            </div>
            <button id="btn-signup" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg shadow-lg shadow-green-500/30 transition transform active:scale-95 flex justify-center items-center gap-2">
                <span>Ø§ÛŒØ¬Ø§Ø¯ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ</span>
            </button>
            <div class="mt-6 text-center text-sm">
                Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯ØŸ <button onclick="switchView('login')" class="text-blue-600 font-bold hover:underline">ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯</button>
            </div>
        </div>

        <div id="reset-form" class="hidden-section space-y-4" style="display: none;">
            <p class="text-sm text-gray-600 text-center mb-4">Ø§ÛŒÙ…ÛŒÙ„ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ ØªØ§ Ù„ÛŒÙ†Ú© Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø±Ø§ÛŒ Ø´Ù…Ø§ Ø§Ø±Ø³Ø§Ù„ Ø´ÙˆØ¯.</p>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">Ø§ÛŒÙ…ÛŒÙ„</label>
                <input type="email" id="reset-email" class="input-field w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:outline-none bg-gray-50">
            </div>
            <button id="btn-reset" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 rounded-lg shadow-lg shadow-purple-500/30 transition transform active:scale-95 flex justify-center items-center gap-2">
                <span>Ø§Ø±Ø³Ø§Ù„ Ù„ÛŒÙ†Ú© Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ</span>
            </button>
            <div class="mt-6 text-center text-sm">
                <button onclick="switchView('login')" class="text-gray-500 hover:text-gray-800 flex items-center justify-center gap-1 mx-auto">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" /></svg>
                    Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙˆØ±ÙˆØ¯
                </button>
            </div>
        </div>
        
        <div id="verify-wait-view" class="hidden-section text-center space-y-4" style="display: none;">
            <div class="bg-blue-100 text-blue-700 p-4 rounded-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                <h3 class="font-bold text-lg">Ø§ÛŒÙ…ÛŒÙ„ ØªØ§ÛŒÛŒØ¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯!</h3>
                <p class="text-sm mt-2">Ù„Ø·ÙØ§Ù‹ ØµÙ†Ø¯ÙˆÙ‚ ÙˆØ±ÙˆØ¯ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ú†Ú© Ú©Ù†ÛŒØ¯. **Ù„ÛŒÙ†Ú© ØªØ§ÛŒÛŒØ¯ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø¯Ø± Ù¾ÙˆØ´Ù‡ Ø§Ø³Ù¾Ù… (Spam/Junk) Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡ Ø¨Ø§Ø´Ø¯.**</p>
                <p class="text-xs mt-3 text-gray-500">Ù¾Ø³ Ø§Ø² ØªØ§ÛŒÛŒØ¯ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ø§ÛŒÙ…ÛŒÙ„ Ø®ÙˆØ¯ ÙˆØ§Ø±Ø¯ Ø­Ø³Ø§Ø¨ Ø´ÙˆÛŒØ¯.</p>
            </div>
            <button onclick="switchView('login')" class="w-full border border-gray-300 text-gray-700 hover:bg-gray-50 font-bold py-2 rounded-lg transition">
                Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯
            </button>
        </div>

    </div>

    <script type="module">
        // ... (Ø§ÛŒÙ…Ù¾ÙˆØ±Øªâ€ŒÙ‡Ø§ Ùˆ Ú©Ø§Ù†ÙÛŒÚ¯ ÙØ§ÛŒØ±Ø¨ÛŒØ³ Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±) ...
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
        import { 
            getAuth, 
            createUserWithEmailAndPassword, 
            signInWithEmailAndPassword, 
            onAuthStateChanged, 
            sendEmailVerification,
            sendPasswordResetEmail,
            // Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ Ø¯Ø± ØµÙˆØ±Øª ÙˆØ±ÙˆØ¯ Ø®ÙˆØ¯Ú©Ø§Ø± Ù†Ø§Ø®ÙˆØ§Ø³ØªÙ‡
            signOut 
        } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

        // Ú©Ø§Ù†ÙÛŒÚ¯ ÙØ§ÛŒØ±Ø¨ÛŒØ³
        const firebaseConfig = {
            apiKey: "AIzaSyD_Zyp4-it4jqoDDKoHQYkJZcW6wpgzNIw",
            authDomain: "rasandesign-c13b0.firebaseapp.com",
            projectId: "rasandesign-c13b0",
            storageBucket: "rasandesign-c13b0.appspot.com",
            messagingSenderId: "704936216056",
            appId: "1:704936216056:web:94050563c2f1320e6bc20d",
            measurementId: "G-G9XXD35REK"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ DOM
        const views = {
            login: document.getElementById('login-form'),
            signup: document.getElementById('signup-form'),
            reset: document.getElementById('reset-form'),
            wait: document.getElementById('verify-wait-view') // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† ÙˆÛŒÙˆ Ø§Ù†ØªØ¸Ø§Ø±
        };
        const alertBox = document.getElementById('alert-box');
        const mainTitle = document.getElementById('main-title');
        const subTitle = document.getElementById('sub-title');

        // ... (ØªÙˆØ§Ø¨Ø¹ switchView, showAlert, getFriendlyErrorMessage, setLoading Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±Ø§Øª Ø§Ø³Ø§Ø³ÛŒ Ø¯Ø± Ù„Ø§Ø¬ÛŒÚ©) ...
        window.switchView = (viewName) => {
            hideAlert();
            const target = views[viewName]; 

            Object.values(views).forEach(el => {
                if (el === target) return;

                el.classList.remove('visible-section');
                el.classList.add('hidden-section');
                
                setTimeout(() => {
                    if (el.classList.contains('hidden-section')) {
                        el.style.display = 'none';
                    }
                }, 500); 
            });

            target.style.display = 'block';
            
            setTimeout(() => {
                target.classList.remove('hidden-section');
                target.classList.add('visible-section');
            }, 10);

            // ØªØºÛŒÛŒØ± ØªØ§ÛŒØªÙ„â€ŒÙ‡Ø§
            if (viewName === 'login') {
                mainTitle.innerText = "Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯";
                subTitle.innerText = "Ù„Ø·ÙØ§Ù‹ ÙˆØ§Ø±Ø¯ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø®ÙˆØ¯ Ø´ÙˆÛŒØ¯";
            } else if (viewName === 'signup') {
                mainTitle.innerText = "Ø§ÛŒØ¬Ø§Ø¯ Ø­Ø³Ø§Ø¨";
                subTitle.innerText = "Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯";
            } else if (viewName === 'reset') {
                mainTitle.innerText = "Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø±Ù…Ø²";
                subTitle.innerText = "Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø®ÙˆØ¯ Ø±Ø§ ÙØ±Ø§Ù…ÙˆØ´ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯ØŸ";
            } else if (viewName === 'wait') { // ØªØ§ÛŒØªÙ„ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ¸Ø§Ø±
                mainTitle.innerText = "ØªØ§ÛŒÛŒØ¯ Ø§ÛŒÙ…ÛŒÙ„";
                subTitle.innerText = "Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØ§ÛŒÛŒØ¯ Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯";
            }
        };
        function showAlert(message, type = 'error') {
            alertBox.className = `mb-4 p-3 rounded-lg text-sm text-center font-medium ${type === 'error' ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'}`;
            alertBox.innerHTML = message;
            alertBox.classList.remove('hidden');
        }
        function hideAlert() {
            alertBox.classList.add('hidden');
        }
        function getFriendlyErrorMessage(error) {
            console.error(error); 
            switch (error.code) {
                case 'auth/email-already-in-use': return 'â›” Ø§ÛŒÙ† Ø§ÛŒÙ…ÛŒÙ„ Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯Ù‡ Ø§Ø³Øª.';
                case 'auth/invalid-email': return 'âš ï¸ ÙØ±Ù…Øª Ø§ÛŒÙ…ÛŒÙ„ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª.';
                case 'auth/user-not-found': return 'âŒ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ø§ÛŒÙ…ÛŒÙ„ ÛŒØ§ÙØª Ù†Ø´Ø¯.';
                case 'auth/wrong-password': return 'ğŸ”’ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª.';
                case 'auth/weak-password': return 'âš ï¸ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û¶ Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯.';
                case 'auth/network-request-failed': return 'ğŸŒ Ø®Ø·Ø§ÛŒ Ø§ØªØµØ§Ù„! Ù„Ø·ÙØ§Ù‹ DNS ÛŒØ§ VPN Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯ (1.1.1.1).';
                case 'auth/too-many-requests': return 'âœ‹ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ§Ø¯ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡. Ù„Ø·ÙØ§Ù‹ Ú©Ù…ÛŒ ØµØ¨Ø± Ú©Ù†ÛŒØ¯.';
                case 'auth/missing-password': return 'Ù„Ø·ÙØ§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.';
                default: return `Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡: ${error.message}`;
            }
        }
        function setLoading(btnId, isLoading, defaultText) {
            const btn = document.getElementById(btnId);
            if (isLoading) {
                btn.disabled = true;
                btn.innerHTML = '<span class="loader"></span> Ú©Ù…ÛŒ ØµØ¨Ø± Ú©Ù†ÛŒØ¯...';
                btn.classList.add('opacity-75', 'cursor-not-allowed');
            } else {
                btn.disabled = false;
                btn.innerHTML = `<span>${defaultText}</span>`;
                btn.classList.remove('opacity-75', 'cursor-not-allowed');
            }
        }


        // ------------------------------------------
        // Ù„Ø§Ø¬ÛŒÚ© Ø«Ø¨Øª Ù†Ø§Ù… (SignUp) - **ØªØºÛŒÛŒØ± Ú©Ù„ÛŒØ¯ÛŒ**
        // ------------------------------------------
        document.getElementById('btn-signup').addEventListener('click', async () => {
            const email = document.getElementById('signup-email').value;
            const pass = document.getElementById('signup-password').value;
            const confirmPass = document.getElementById('signup-confirm-password').value;

            if (!email || !pass) return showAlert('Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯.');
            if (pass !== confirmPass) return showAlert('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ùˆ ØªÚ©Ø±Ø§Ø± Ø¢Ù† Ù…Ø·Ø§Ø¨Ù‚Øª Ù†Ø¯Ø§Ø±Ù†Ø¯.');

            setLoading('btn-signup', true, '');
            
            try {
                // 1. Ø³Ø§Ø®Øª Ø§Ú©Ø§Ù†Øª
                const userCredential = await createUserWithEmailAndPassword(auth, email, pass);
                const user = userCredential.user;

                // 2. Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ…ÛŒÙ„ ØªØ§ÛŒÛŒØ¯ÛŒÙ‡
                await sendEmailVerification(user);

                // 3. **Ø®Ø±ÙˆØ¬ Ú©Ø§Ø±Ø¨Ø± ØªØ§Ø²Ù‡ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ø±Ø¯Ù‡:** // Ú†ÙˆÙ† Firebase Ù¾Ø³ Ø§Ø² Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ù„Ø§Ú¯ÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ØŒ Ø¨Ø§ÛŒØ¯ Ø®Ø±ÙˆØ¬ Ø±Ø§ Ø§Ø¹Ù…Ø§Ù„ Ú©Ù†ÛŒÙ….
                await signOut(auth); 

                // 4. Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ù…ÙˆÙÙ‚ÛŒØª Ùˆ ØµÙØ­Ù‡ Ø§Ù†ØªØ¸Ø§Ø±
                showAlert('âœ… Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯! Ù„Ø·ÙØ§Ù‹ Ø§ÛŒÙ…ÛŒÙ„ Ø®ÙˆØ¯ Ø±Ø§ ØªØ§ÛŒÛŒØ¯ Ú©Ù†ÛŒØ¯.', 'success');
                switchView('wait');
                
                // Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ ÙØ±Ù…
                document.getElementById('signup-email').value = '';
                document.getElementById('signup-password').value = '';
                document.getElementById('signup-confirm-password').value = '';

            } catch (error) {
                showAlert(getFriendlyErrorMessage(error));
            } finally {
                setLoading('btn-signup', false, 'Ø§ÛŒØ¬Ø§Ø¯ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ');
            }
        });

        // ------------------------------------------
        // Ù„Ø§Ø¬ÛŒÚ© ÙˆØ±ÙˆØ¯ (Login) - **ØªØºÛŒÛŒØ± Ú©Ù„ÛŒØ¯ÛŒ**
        // ------------------------------------------
        document.getElementById('btn-login').addEventListener('click', async () => {
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-password').value;

            if (!email || !pass) return showAlert('Ù„Ø·ÙØ§Ù‹ Ø§ÛŒÙ…ÛŒÙ„ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');

            setLoading('btn-login', true, '');

            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, pass);
                const user = userCredential.user;

                // Ø¨Ø±Ø±Ø³ÛŒ ØªØ§ÛŒÛŒØ¯ Ø§ÛŒÙ…ÛŒÙ„ Ù‡Ù†Ú¯Ø§Ù… ÙˆØ±ÙˆØ¯
                if (!user.emailVerified) {
                    // Ø§Ú¯Ø± Ø§ÛŒÙ…ÛŒÙ„ ØªØ§ÛŒÛŒØ¯ Ù†Ø´Ø¯Ù‡ØŒ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ù„Ø§Ú¯ Ø§ÙˆØª Ú©Ø±Ø¯Ù‡ Ùˆ Ù‡Ø´Ø¯Ø§Ø± Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…
                    await signOut(auth); 
                    showAlert('âŒ ÙˆØ±ÙˆØ¯ Ù†Ø§Ù…ÙˆÙÙ‚. Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ Ø§ÛŒÙ…ÛŒÙ„ Ø®ÙˆØ¯ Ø±Ø§ ØªØ§ÛŒÛŒØ¯ Ú©Ù†ÛŒØ¯ (Ù„ÛŒÙ†Ú© Ø¯Ø± Ø§ÛŒÙ†Ø¨Ø§Ú©Ø³ ÛŒØ§ Ø§Ø³Ù¾Ù… Ø´Ù…Ø§Ø³Øª).', 'error');
                    
                    // Ù‡Ù…Ú†Ù†ÛŒÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ù‡ ØµÙØ­Ù‡ Ø§Ù†ØªØ¸Ø§Ø± Ù‡Ø¯Ø§ÛŒØª Ú©Ø±Ø¯
                    // switchView('wait'); 
                    
                } else {
                    // Ø§Ú¯Ø± ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡ØŒ onAuthStateChanged Ø§Ùˆ Ø±Ø§ Ø¨Ù‡ dashboard.html Ù‡Ø¯Ø§ÛŒØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯
                    showAlert('âœ… ÙˆØ±ÙˆØ¯ Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ². Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯...', 'success');
                }

            } catch (error) {
                showAlert(getFriendlyErrorMessage(error));
            } finally {
                setLoading('btn-login', false, 'ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø­Ø³Ø§Ø¨');
            }
        });

        // ------------------------------------------
        // Ù„Ø§Ø¬ÛŒÚ© Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø±Ù…Ø² (Forgot Password) - (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±)
        // ------------------------------------------
        document.getElementById('btn-reset').addEventListener('click', async () => {
            const email = document.getElementById('reset-email').value;
            if (!email) return showAlert('Ù„Ø·ÙØ§Ù‹ Ø§ÛŒÙ…ÛŒÙ„ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');

            setLoading('btn-reset', true, '');

            try {
                await sendPasswordResetEmail(auth, email);
                showAlert('ğŸ“© Ù„ÛŒÙ†Ú© Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯. Ø§ÛŒÙ…ÛŒÙ„ Ø®ÙˆØ¯ Ø±Ø§ Ú†Ú© Ú©Ù†ÛŒØ¯.', 'success');
            } catch (error) {
                showAlert(getFriendlyErrorMessage(error));
            } finally {
                setLoading('btn-reset', false, 'Ø§Ø±Ø³Ø§Ù„ Ù„ÛŒÙ†Ú© Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ');
            }
        });

        // ------------------------------------------
        // Ù¾Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª Ú©Ø§Ø±Ø¨Ø± Ùˆ Ø±ÛŒØ¯Ø§ÛŒØ±Ú©Øª - **ØªØºÛŒÛŒØ± Ú©Ù„ÛŒØ¯ÛŒ**
        // ------------------------------------------
        onAuthStateChanged(auth, (user) => {
            // Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ø¯Ø± Ù‡Ø± Ø¨Ø§Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡ ÛŒØ§ ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª ÙˆØ±ÙˆØ¯ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯
            if (user) {
                // Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ù„Ø§Ú¯ÛŒÙ† Ø§Ø³ØªØŒ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… Ú©Ù‡ Ø§ÛŒÙ…ÛŒÙ„Ø´ ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯
                if (user.emailVerified) {
                    // Ø§Ú¯Ø± Ø§ÛŒÙ…ÛŒÙ„ ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡ØŒ Ø¨Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù‡Ø¯Ø§ÛŒØª Ø´ÙˆØ¯.
                    console.log("User Verified. Redirecting to dashboard.");
                    window.location.href = 'dashborud.html';
                } else {
                    // Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ù„Ø§Ú¯ÛŒÙ† Ø§Ø³Øª Ø§Ù…Ø§ Ø§ÛŒÙ…ÛŒÙ„ ØªØ§ÛŒÛŒØ¯ Ù†Ø´Ø¯Ù‡ØŒ Ø¯Ø± Ù‡Ù…ÛŒÙ† ØµÙØ­Ù‡ Ù„Ø§Ú¯ÛŒÙ†/Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯.
                    // (Ø¨Ù‡ Ø´Ø±Ø·ÛŒ Ú©Ù‡ Ø¯Ø± ØªØ§Ø¨Ø¹ signup Ø§Ùˆ Ø±Ø§ Ù„Ø§Ú¯ Ø§ÙˆØª Ú©Ø±Ø¯Ù‡ Ø¨Ø§Ø´ÛŒÙ…)
                    console.log("User logged in but not verified. Staying on login page.");
                    // Ø¯Ø± Ø§ÛŒÙ† Ø­Ø§Ù„Øª Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ù„Ø§Ú¯ÛŒÙ† Ø¨Ù…Ø§Ù†Ø¯ØŒ Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù„ÙˆÙ¾ Ø´Ø¯Ù†ØŒ Ú©Ø§Ø±ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
                    // Ùˆ Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ… Ú©Ø§Ø±Ø¨Ø± Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒÛŒØ¯ Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ù‡ Ø§ÛŒÙ†Ø¨Ø§Ú©Ø³Ø´ Ø¨Ø±ÙˆØ¯.
                }

            } else {
                // Ú©Ø§Ø±Ø¨Ø± Ù„Ø§Ú¯ÛŒÙ† Ù†ÛŒØ³Øª.
                // Ø§Ú¯Ø± Ø¯Ø± ØµÙØ­Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø¨ÙˆØ¯ØŒ Ø¨Ù‡ ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯.
                if (window.location.pathname.endsWith('dashborud.html')) {
                    window.location.href = 'index.html'; 
                } else {
                    // Ù†Ù…Ø§ÛŒØ´ ÙˆÛŒÙˆ ÙˆØ±ÙˆØ¯ Ø¯Ø± Ø­Ø§Ù„Øª Ø¹Ø§Ø¯ÛŒ
                    // Ø§ÛŒÙ† Ø®Ø· ØªØ¶Ù…ÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ ØµÙØ­Ù‡ Ø¯Ø± Ø­Ø§Ù„Øª Ø§ÙˆÙ„ÛŒÙ‡ Ø¯Ø±Ø³Øª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯ Ù…Ú¯Ø± Ø§ÛŒÙ†Ú©Ù‡ Ø¯Ø± ÙˆÛŒÙˆ Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø§Ø´Ø¯.
                    if (!document.body.classList.contains('auth-check-done')) {
                        window.switchView('login');
                        document.body.classList.add('auth-check-done');
                    }
                }
            }
        });

    </script>
</body>
</html>
